<!DOCTYPE html>
<html>
<head>
  <title>Realtime Product Trade</title>
</head>
<body>
  <h2>Add Product</h2>
  <input id="title" placeholder="Product Name">
  <input id="price" placeholder="Price">
  <button id="uploadBtn">Upload</button>

  <h2>Product List</h2>
  <ul id="productList"></ul>

  <!-- Firebase Scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-database.js";

    // YOUR FIREBASE CONFIG (REPLACE WITH YOUR ACTUAL VALUES)
    const firebaseConfig = {
        apiKey: "AIza...", // <-- HIDE THIS, USE YOURS
        authDomain: "ecommers-9a3f9.firebaseapp.com",
        // âœ… ADDED THIS LINE - Get it from your Firebase console
        databaseURL: "https://ecommers-9a3f9-default-rtdb.firebaseio.com",
        projectId: "ecommers-9a3f9",
        storageBucket: "ecommers-9a3f9.appspot.com", // <-- Corrected suffix from firebasestorage.app
        messagingSenderId: "701672006986",
        appId: "1:701672006986:web:00e1ef9e1f40050ba58db3",
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const productsRef = ref(db, "products"); // Good practice to define the ref once

    // Upload product
    document.getElementById("uploadBtn").addEventListener("click", () => {
      const title = document.getElementById("title").value;
      const price = document.getElementById("price").value;
      if (title && price) {
        push(productsRef, { 
          title: title, 
          price: price 
        });
        document.getElementById("title").value = "";
        document.getElementById("price").value = "";
      }
    });

    // Show products in real-time
    const productList = document.getElementById("productList");
    onValue(productsRef, (snapshot) => {
      productList.innerHTML = ""; // Clear the list before repopulating
      if (snapshot.exists()) {
        snapshot.forEach((childSnapshot) => {
          const item = childSnapshot.val();
          // Create list item elements properly to avoid potential HTML injection
          const li = document.createElement('li');
          li.textContent = `${item.title} - ${item.price}`;
          productList.appendChild(li);
        });
      } else {
        productList.innerHTML = "<li>No products yet.</li>";
      }
    });
  </script>
</body>
</html>